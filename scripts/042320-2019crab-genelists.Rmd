---
title: "2019-crab-macropinocytosis"
output: html_document
---
Rmd to get genes associated with macropinocytosis GO term that was enriched according to DAVID when comparing the 772 DEG list from the 2019 crab infection comparison to the annotated crab transcriptome. 

```{r}
library(tidyverse)
library(dplyr)
library(stringr)
```

## Upload files
Upload list of 772 DEGs from 2019 crab data
```{r}
degs <- read.delim("../analyses/2019-DEGlist-infection-colnames.txt", sep = '\t')
head(degs)
```
Upload GO database downloaded from uniprot.org (too large to be on github --> saved locally)
```{r}
go <- read.delim("../data/uniprot-reviewed.tab", sep = '\t')
head(go)
```

upload the crab trasncriptome BLAST output
```{r}
blast <- read.delim("../analyses/crab-blastout.txt", header = FALSE)
head(blast)
```
rename the columnsfor the blast table
```{r}
colnames(blast) <- c("Trinity_ID", "V2", "Entry", "V4", "V5", "V6", "V7", "V8", "V9", "V10", "V11", "V12", "V13", "V14")
head(blast)
```

## Annotate the DEG list
`join` the deg list with the blast output by "Trinity_ID"

```{r}
degs_annot <- left_join(degs, blast, by = "Trinity_ID")
head(degs_annot)
```

## Get GO information for DEG list
`join` the go database with the annotated DEG list by "Entry"

```{r}
degs_annot_GO <- left_join(degs_annot, go, by = "Entry")
head(degs_annot_GO)
```

## Get list of genes to do with macropinocytosis
pull out rows that contain "macropinocytosis"

```{r}
macro <- degs_annot_GO %>%
  filter(str_detect(Gene.ontology.IDs, "GO:0044351"))
head(macro)
```

```{r}
blast_annot <- left_join(blast, go, by = "Entry")
head(blast_annot)
```

```{r}
stress <- blast_annot %>%
  filter(str_detect(Gene.ontology..biological.process., "stress"))
head(stress)
```

## April 24, 2020
Getting list of 12 things that contribute to macropinocytosis

Upload the DAVID output
```{r}
david <- read.delim("../analyses/chart_12EFD.txt", header = TRUE)
head(david)
```

Pull out list of 12 Uniprot Accession IDs from the first row for macropinocytosis
```{r}
genes_macro <- c("Q54QS3", "P20054", "Q54E04", "Q54JP5", "Q8T6J5", "Q54ES9", "Q55E60", "Q5VZK9", "Q54IZ9", "Q54GE3", "Q54JC8", "Q54J75")
```

Need to figure out code to get the above vector into a column... but I just copy and pasted them into excel and I'll read in the column now:
```{r}
genes_macro_col <- read.delim("../analyses/macropinocytosis_uniprotAcc-ids.csv")
head(genes_macro_col)
```

Get the info on those genes by `join`-ing with the GO database:
```{r}
genes_macro_annot <- left_join(genes_macro_col, go, by = "Entry")
head(genes_macro_annot)
```

write out this as a table in analyses:
```{r}
write.table(genes_macro_annot, "../analyses/macropinocytosis_gene_list.tab", quote = FALSE, row.names = FALSE, sep = '\t')
```




