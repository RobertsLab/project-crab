---
title: "2019-crab-infection-for-DAVID"
output: github_document
---
Rmd to make Uniprot Accession # lists to put in DAVID. Lists will be: 
1. backgound --> crab transcriptome Uniprot Accession IDs
2. gene list --> 2019 crab dataset comparing infection status DEG list from SR (772 DEGs) Uniprot Accession IDs

```{r}
library(tidyverse)
```

## Upload files: 

BLAST output from the whole crab transcriptome: 
(I had pasted in excel to get the data into correct columns)
```{r}
blastout <- read.delim("../analyses/crab-blastout.txt", header = FALSE)
head(blastout)
```
Rename some of the column for `join`-ing purposes: 
```{r}
colnames(blastout) <- c("Trinity_ID", "V2", "Entry", "V4", "V5", "V6", "V7", "V8", "V9", "V10", "V11", "V12", "V13", "V14")
head(blastout)
```

List of 772 DEGs from SR (made using `DESeq`): 
(I had put in excel to save the data into correct columns)
```{r}
degs <- read.delim("../analyses/2019-DEGlist-infection-colnames.txt")
head(degs)
```

## Create the background list of Uniprot Accession IDs
save just the column "ENTRY" (Uniprot Accession IDs) to project-crab/analyses
```{r}
background <- subset(blastout, select = c(Entry))
head(background)
```

write it out 
```{r}
write.csv(background, "../analyses/crab_transc-uniprotacc-for-DAVID.csv", row.names = FALSE, quote = FALSE)
```

## Create the gene list for the 772 DEGs
`join` the DEG list with the BLAST output from the crab transcriptome to get the 772 DEG list uniprot accession IDs
```{r}
deg_annot <- left_join(degs, blastout, by = "Trinity_ID")
head(deg_annot)
```
Save the "Entry" column 
```{r}
genelist <- subset(deg_annot, select = c(Entry))
head(genelist)
```

remove NAs from the list:
```{r}
genelist <- na.omit(genelist)
head(genelist)
```
There are now 646 Entries... maybe i should have done BLAST on list of DEGs to get Entries instead of `join` with the BLAST output from the crab transcriptome... 

write out
```{r}
write.csv(genelist, "../analyses/2019-genelist-for-DAVID.csv", quote = FALSE, row.names = FALSE)
```
