---
title: "sep_crab-hemat"
output: github_document
---

R markdown file to separate genes related to _Hematodinium_ and crabs.

Join uniprot-transcriptome BLAST with dinoflagellate-transcriptome BLAST

What doesn't match is crab. 
Create 2 tables: Hematodinium-related and Crab-related. 

Get GOslim terms for each table separately, and dig deeper into genes separately. 

```{r}
library(dplyr)
library(tidyverse)
library(data.table)
```

Read in dinoflagellate-transcriptome BLAST output:
```{r}
dino <- read.table("http://owl.fish.washington.edu/scaphapoda/grace/PCSGA-2019/Cb_v1_blastx_uniprot2864_imac.tab", sep = '\t', header = FALSE)
```

Read in uniprot-transcriptome BLAST output: 
```{r}
uni <- read.csv("../../../GitHub/grace-Cbairdi-transcriptome/analyses/Blastquery-GOslim-sep.csv", header = TRUE)
```

Rename columns
```{r}
dcol <- c("Trinity_protein", "sseqid", "pident", "length", "mismatch", "gapopen", "qstart", "qend", "sstart", "send", "evalue", "bitscore")
colnames(dino) <- dcol
```

Join tables based on trinity
```{r}
crab <- anti_join(uni, dino, by = "Trinity_protein")
```

Save crab and dino separately into analyses
```{r}
write.csv(crab, "../analyses/crab-GOslim.csv")
write.table(dino, "../analyses/hemat-blastx-output.tab")
```

Next step: use jupyter notebook to annotate dinoflagellate blastx output. 

