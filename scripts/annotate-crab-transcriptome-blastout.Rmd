---
title: "annotate-crab-transcriptome-GO"
output: html_document
---
Rmd to annotate the BLAST output from the crab transcriptome with GO terms from uniprot.org. 

```{r}
library(dplyr)
library(tidyverse)
```

Read in BLAST output from crab transcriptome:
```{r}
blastout <- read.delim("../analyses/BLAST_to_GOslim/_blast-sep.tab", sep = '\t', header = FALSE)
head(blastout)
```
14 cols, 23,065 rows

Rename columns: 
```{r}
colnames(blastout) <- c("Trinity_ID", "V2", "uniprot_acc_ID", "V4", "V5", "V6", "V7", "V8", "V9", "V10", "V11", "V12", "V13", "V14")
head(blastout)
```

Read in uniprot-SP-GO.sorted file:
```{r}
uniprot_sp_GO <- read.delim("http://owl.fish.washington.edu/halfshell/bu-alanine-wd/17-07-20/uniprot-SP-GO.sorted", sep = '\t', header = FALSE)
head(uniprot_sp_GO)
```

Rename some columns: 
```{r}
colnames(uniprot_sp_GO) <- c("uniprot_acc_ID", "entry_name", "review_status", "protein_name", "gene_name", "organism", "length", "V8", "V9", "V10", "V11", "gene_ontology_IDs")
head(uniprot_sp_GO)
```

`join` the two files: 
```{r}
blastout_sp_go <- left_join(blastout, uniprot_sp_GO, by = "uniprot_acc_ID")
head(blastout_sp_go)
```

resulting file is 23,065 rows with 25 columns

Check to see how many were annotated with GO: 
```{r}
yes_go <- blastout_sp_go[grep("reviewed", blastout_sp_go$review_status), ]
head(yes_go)
```
Created an object with 11,503 observation, so 11,503 of the 23,065 blast output genes were able to be annotated with GO. 

Write out to project-crab/analyses:
```{r}
write.table(blastout_sp_go, "../analyses/crab_transc-sp-GO.tab", sep = '\t', quote = FALSE, row.names = FALSE)
```




