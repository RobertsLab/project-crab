---
title: 'annotate and enrich 2019 crab: infected vs uninfected'
output: github_document
---
Rmd for annotating a list of 773 DEGs from Steven (crab data 2019 - comparing infected and uninfected only). 

Files needed: 
1. 772 DEG list (2019-infection_DEGlist.tab) in project-crab/analyses
2. BLAST output from the crab transcriptome 
3. uniprot GO list (downloaded from uniprot.org - entire list with added columns of GO terms and IDs)

```{r}
#install.packages("tidyverse")
library(tidyverse)
```

# Annotation
## Upload files
DEGlist was made by SR - compares infected and uninfected from the 2019 dataset
Upload DEG list:
(I pasted list into excel in order to name the first column "Trinity_ID")
```{r}
degs <- read.table("../analyses/2019-DEGlist-infection-colnames.txt", header = TRUE)
head(degs)
```
Upload BLAST output from crab transcriptome: 
(I pasted into excel to get the data into the correct columns...)
```{r}
blastout <- read.delim("../analyses/crab-blastout.txt", header = FALSE)
head(blastout)
```
Rename column "V3" --> "Entry" so that it matches the column name rom the uniprot ID list; also rename column "V1" --> "Trinity_ID"
```{r}
colnames(blastout) <- c("Trinity_ID", "V2", "Entry", "V4", "V5", "V6", "V7", "V8", "V9", "V10", "V11", "V12", "V13", "V14")
head(blastout)
```

Upload uniprot GO list:
(File too big to be on Github --> downloaded and stored locally in my github repo for project-crab)
But I downloaded the entire uniprot ID list with all GO IDs
```{r}
go <- read.delim("../data/uniprot-reviewed.tab", sep = '\t', header = TRUE)
head(go)
```

## Annotate blastout file with GO terms (downloaded from uniprot.org)
Join based on uniprot ID (Column "Entry")

```{r}
annot_blast <- left_join(blastout, go, by = "Entry")
head(annot_blast)
```
Resulted in a file that is the same length as 'blastout' (23065 rows) with 24 columns. Seems to have worked well! 

## Annotate DEG list
Now that the blast output is annotated and the column with the Trinity IDs matches the same name as that in the DEGlist, the files are ready to be `join`-ed!
```{r}
degs_annot <- left_join(degs, annot_blast, by = "Trinity_ID")
head(degs_annot)
```
Resulting file is 783 rows (deg list is 772) and 30 columns. 

Annotation = complete. 

# Enrichment
EIMD 2019 class used GO-MWU for enrichment
"rank-based gene ontology analysis" 

















