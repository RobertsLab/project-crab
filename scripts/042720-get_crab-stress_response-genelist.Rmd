---
title: "get-stress-gene-list"
output: html_document
---
Rmd to get the list of 5317 stress response genes that were identified using  https://github.com/RobertsLab/project-crab/blob/master/notebooks/042320-bairdi_transcriptome-BLAST-to-GOslim.ipynb.

Make a list of the genes that have the GOslim term "stress response" from the full, annotated crab transcriptome. List should be 5317 rows. 


```{r}
library(tidyverse)
library(dplyr)
```

### Read in the uniprot-SP-GO.sorted file from the jupyter notebook:
```{r}
uniprot_sp_GO <- read.delim("http://owl.fish.washington.edu/halfshell/bu-alanine-wd/17-07-20/uniprot-SP-GO.sorted", sep = '\t', header = FALSE)
head(uniprot_sp_GO)
```
168361 rows, 12 columns. 
#### Rename column "V1" to "uniprot_acc_ID"
```{r}
colnames(uniprot_sp_GO) <- c("uniprot_acc_ID", "entry_name", "review_status", "protein_name", "gene_name", "organism", "length", "V8", "V9", "V10", "V11", "gene_ontology_IDs")
head(uniprot_sp_GO)
```


### Read in the `BLAST` output, but the one that is called "_blast-sep.tab" from the above jupyter notebook
```{r}
blastout <- read.delim("../analyses/BLAST_to_GOslim/_blast-sep.tab", sep = '\t', header = FALSE)
head(blastout)
```
23605 rows, 14 columns

#### Rename columnn "V3" "uniprot_acc_ID"
```{r}
colnames(blastout) <- c("Trinity_ID", "V2", "uniprot_acc_ID", "V4", "V5", "V6", "V7", "V8", "V9", "V10", "V11", "V12", "V13", "V14")
head(blastout)
```

### `join` blastout and uniprot_sp_GO by "uniprot_acc_ID" column:
```{r}
blastout_uniprot <- left_join(blastout, uniprot_sp_GO, by = "uniprot_acc_ID")
head(blastout_uniprot)
```
same amount of rows as the blastout... good to go. 

### Read in the table from the BLAST to GOslim jupter notebook linked above called "Blastquery-GOslim.tab". (file is saved locally on my computer)
```{r}
blastquery_goslim <- read.table("../analyses/BLAST_to_GOslim/Blastquery-GOslim.tab", sep = '\t')
head(blastquery_goslim)
```
#### add column names
```{r}
colnames(blastquery_goslim) <- c("Trinity_ID", "GO_ID", "GOslim", "biological_process")
head(blastquery_goslim)
```

#### Call out the GOslim terms that have the word "stress" in them: 
```{r}
stress <- blastquery_goslim %>%
  filter(str_detect(GOslim, "stress"))
head(stress)
```

List is 5317 rows! Excellent!

### `join` the stress list with the annotated blast output (blastout_uniprot)
```{r}
stress_annot <- left_join(blastout_uniprot, stress, by = "Trinity_ID")
head(stress_annot)
```
Not all were annotated with GO. 

Write out table:
```{r}
write.table(stress_annot, "../analyses/crab_stress-response-genes.tab", sep = '\t', quote = FALSE, row.names = FALSE)
```




